{% extends 'admin/layout.html.twig' %}
{% block title %}Tous les produits{% endblock title %}

{% block admin_content %}
    <h1 class="mb-4">Produits</h1>

    {{ form_start(form) }}
    {{ form_widget(form) }}
    {{ form_end(form) }}

    <table class="table table-hover">
        <thead>
            <tr class="row">
                <th class="col-md-2 d-sm-table-cell d-none"></th>
                <th class="col-md d-sm-table-cell d-none">Nom</th>
                <th class="col-md d-sm-table-cell d-none">Catégorie</th>
                <th class="col-md d-sm-table-cell d-none">Stock</th>
            </tr>
        </thead>
        {% if products is not empty %}
            {% for product in products %}
            <tr class="row tr-link" data-href="{{ path('admin_product-editor', {'id': product.id }) }}">
                <td class="col-md-2 d-sm-table-cell d-block">
                    {% set thumb = product.images|first %}
                    <img src="/img/upload/{{ thumb.name }}" alt="{{ thumb.description }}" class="product__img img img-fluid">
                </td>
                <td class="col-md d-sm-table-cell d-block">{{ product.name }}</td>
                <td class="col-md d-sm-table-cell d-block">{{ product.category }}</td>
                <td class="col-md d-sm-table-cell d-block">{{ product.stock }}</td>
            </tr>
            {% endfor %}
        {% else %}
        <tr><td>Aucun résultat</td></tr>
        {% endif %}
    </table>
    
    <nav class="mt-4">
        <ul class="pagination">
            {% if currentPage == 1 %}
                <li class="page-item disabled">
                    <span class="page-link">Précédent</span>
                </li>
            {% else %}
                <a href="{{ path('admin_all-products', {'page': currentPage - 1 }) }}" class="page-link">Précédent</a>
            {% endif %}
            
            {% for p in 1..totalPages %}
                {% if p == currentPage %}
                    <li class="page-item active">
                        <a href="{{ path('admin_all-products', {'page': p }) }}" class="page-link">{{ p }}</a>
                    </li>
                {% else %}
                    <li class="page-item">
                        <a href="{{ path('admin_all-products', {'page': p }) }}" class="page-link">{{ p }}</a>
                    </li>
                {% endif %}
            {% endfor %}
            
            {% if currentPage == totalPages %}
                <li class="page-item disabled">
                    <span class="page-link">Suivant</span>
                </li>
            {% else %}
                <a href="{{ path('admin_all-products', {'page': currentPage + 1 }) }}" class="page-link">Suivant</a>
            {% endif %}
        </ul>
    </nav>

{% endblock %}

{% block javascripts %}
    <script src="/js/allProducts.js"></script>
{% endblock %}
